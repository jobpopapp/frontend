<div class="dashboard-layout d-flex">
  <!-- Sidebar -->
  <app-sidebar class="sidebar"></app-sidebar>

  <!-- Main Content -->
  <div class="main-content flex-grow-1">
    <!-- Navbar -->
    <app-navbar></app-navbar>

    <!-- Dashboard Content -->
    <div class="container-fluid p-4">
      <!-- Welcome Section -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card bg-primary text-light fade-in-up">
            <div class="card-body">
              <h1 class="h2 fw-bold mb-2 text-light">
                Welcome back, {{ currentCompany?.name }}!
              </h1>
              <p class="mb-0 opacity-75">
                Manage your job postings and track applications from your
                dashboard with our Adobe-inspired interface.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Stats Cards -->
      <div class="row mb-4">
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card stat-card h-100 slide-in-right">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <div class="stat-icon bg-primary text-light rounded-3 p-3 me-3">
                  <i class="bi bi-briefcase fs-4"></i>
                </div>
                <div>
                  <h3 class="fw-bold mb-1 text-primary">
                    {{ dashboardStats.totalJobs }}
                  </h3>
                  <p class="text-muted mb-0 small">Total Jobs Posted</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card stat-card h-100 slide-in-right">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <div
                  class="stat-icon bg-accent text-secondary rounded-3 p-3 me-3"
                >
                  <i class="bi bi-check-circle fs-4"></i>
                </div>
                <div>
                  <h3 class="fw-bold mb-1">{{ dashboardStats.activeJobs }}</h3>
                  <p class="text-muted mb-0 small">Active Jobs</p>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-3 col-md-6 mb-3">
            <div class="stat-card p-4 h-100">
              <div class="d-flex align-items-center">
                <div
                  class="stat-icon bg-info bg-opacity-10 text-info rounded-3 p-3 me-3"
                >
                  <i class="bi bi-people fs-4"></i>
                </div>
                <div>
                  <h3 class="fw-bold mb-1">
                    {{ dashboardStats.totalApplications }}
                  </h3>
                  <p class="text-muted mb-0 small">Total Applications</p>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-3 col-md-6 mb-3">
            <div class="stat-card p-4 h-100">
              <div class="d-flex align-items-center">
                <div
                  class="stat-icon bg-warning bg-opacity-10 text-warning rounded-3 p-3 me-3"
                >
                  <i class="bi bi-clock fs-4"></i>
                </div>
                <div>
                  <h3 class="fw-bold mb-1">{{ subscriptionDaysLeft }}</h3>
                  <p class="text-muted mb-0 small">Days Left</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Action Cards -->
        <div class="row mb-4">
          <div class="col-md-8">
            <!-- Recent Jobs -->
            <div class="card border-0 shadow-sm h-100">
              <div
                class="card-header bg-transparent border-0 d-flex justify-content-between align-items-center"
              >
                <h5 class="card-title mb-0 fw-semibold">Recent Job Postings</h5>
                <a routerLink="/jobs" class="btn btn-sm btn-outline-primary"
                  >View All</a
                >
              </div>
              <div class="card-body">
                <div *ngIf="recentJobs.length === 0" class="text-center py-4">
                  <i class="bi bi-briefcase text-muted display-4 mb-3"></i>
                  <h6 class="text-muted">No jobs posted yet</h6>
                  <p class="text-muted small mb-3">
                    Start by posting your first job to attract top talent.
                  </p>
                  <a routerLink="/jobs/new" class="btn btn-primary">
                    <i class="bi bi-plus-circle me-2"></i>Post Your First Job
                  </a>
                </div>

                <div *ngIf="recentJobs.length > 0" class="job-list">
                  <div
                    *ngFor="let job of recentJobs"
                    class="job-item d-flex justify-content-between align-items-center p-3 border-bottom"
                  >
                    <div>
                      <h6 class="mb-1 fw-semibold">{{ job.title }}</h6>
                      <p class="text-muted small mb-1">
                        {{ job.location }} â€¢ {{ job.job_type | titlecase }}
                      </p>
                      <span class="badge bg-success-subtle text-success small"
                        >Active</span
                      >
                    </div>
                    <div class="text-end">
                      <p class="text-muted small mb-1">
                        Posted {{ getTimeAgo(job.created_at) }}
                      </p>
                      <div class="btn-group btn-group-sm">
                        <a
                          [routerLink]="['/jobs/edit', job.id]"
                          class="btn btn-outline-primary btn-sm"
                        >
                          <i class="bi bi-pencil"></i>
                        </a>
                        <button class="btn btn-outline-secondary btn-sm">
                          <i class="bi bi-eye"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-4">
            <!-- Quick Actions & Subscription Status -->
            <div class="card border-0 shadow-sm mb-3">
              <div class="card-header bg-transparent border-0">
                <h5 class="card-title mb-0 fw-semibold">Quick Actions</h5>
              </div>
              <div class="card-body">
                <div class="d-grid gap-2">
                  <a routerLink="/jobs/new" class="btn btn-primary">
                    <i class="bi bi-plus-circle me-2"></i>Post New Job
                  </a>
                  <a routerLink="/jobs" class="btn btn-outline-primary">
                    <i class="bi bi-briefcase me-2"></i>Manage Jobs
                  </a>
                  <a
                    routerLink="/subscription"
                    class="btn btn-outline-secondary"
                  >
                    <i class="bi bi-credit-card me-2"></i>Subscription
                  </a>
                </div>
              </div>
            </div>

            <!-- Subscription Status -->
            <div class="card border-0 shadow-sm">
              <div class="card-header bg-transparent border-0">
                <h5 class="card-title mb-0 fw-semibold">Subscription Status</h5>
              </div>
              <div class="card-body">
                <div
                  *ngIf="subscriptionStatus === 'active'"
                  class="text-center"
                >
                  <i class="bi bi-check-circle-fill text-success fs-2 mb-2"></i>
                  <h6 class="text-success">Active Plan</h6>
                  <p class="text-muted small mb-0">
                    {{ subscriptionDaysLeft }} days remaining
                  </p>
                </div>

                <div
                  *ngIf="subscriptionStatus === 'expired'"
                  class="text-center"
                >
                  <i
                    class="bi bi-exclamation-triangle-fill text-warning fs-2 mb-2"
                  ></i>
                  <h6 class="text-warning">Plan Expired</h6>
                  <p class="text-muted small mb-3">
                    Renew to continue posting jobs
                  </p>
                  <a routerLink="/subscription" class="btn btn-warning btn-sm"
                    >Renew Now</a
                  >
                </div>

                <div *ngIf="subscriptionStatus === 'none'" class="text-center">
                  <i class="bi bi-info-circle-fill text-info fs-2 mb-2"></i>
                  <h6 class="text-info">No Active Plan</h6>
                  <p class="text-muted small mb-3">
                    Choose a plan to start posting jobs
                  </p>
                  <a routerLink="/subscription" class="btn btn-primary btn-sm"
                    >Choose Plan</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Verification Status (if not verified) -->
        <div *ngIf="!isVerified" class="row">
          <div class="col-12">
            <div class="alert alert-warning border-0 shadow-sm" role="alert">
              <div class="d-flex align-items-center">
                <i class="bi bi-exclamation-triangle-fill me-3 fs-4"></i>
                <div class="flex-grow-1">
                  <h6 class="alert-heading mb-1">
                    Account Verification Required
                  </h6>
                  <p class="mb-2">
                    Please upload your Certificate of Incorporation to verify
                    your company account.
                  </p>
                  <button
                    class="btn btn-warning btn-sm"
                    (click)="openUploadModal()"
                  >
                    <i class="bi bi-upload me-2"></i>Upload Certificate
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
